<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>音程助记</title>
    <style>
        :root {
            --bg-dark: #0a0c0e;
            --card-bg: #16191d;
            --accent: #00d4ff;
            --accent-glow: rgba(0, 212, 255, 0.35);
            --root: #00d4ff;
            --target: #2ecc71;
            --text-main: #ffffff;
            --text-dim: #9aa6ad;
            --white-key: #f5f7fa;
            --black-key: #1f252b;
        }

        * {
            box-sizing: border-box;
        }

        html,
        body {
            margin: 0;
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg-dark);
            color: var(--text-main);
            overflow-x: hidden;
        }

        .page {
            max-width: 1280px;
            margin: 0 auto;
            padding: 16px;
            overflow-x: hidden;
        }

        h1 {
            margin: 0 0 12px;
            color: var(--accent);
            font-size: 1.2rem;
            letter-spacing: 0.5px;
        }

        .toolbar {
            position: sticky;
            top: 0;
            z-index: 10;
            background: var(--bg-dark);
            padding-bottom: 10px;
        }

        .interval-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(78px, 1fr));
            gap: 8px;
        }

        .interval-btn {
            border: 1px solid rgba(255, 255, 255, 0.15);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-main);
            border-radius: 8px;
            padding: 8px 6px;
            font-size: 0.8rem;
            cursor: pointer;
        }

        .interval-btn.active {
            background: var(--accent);
            color: #000;
            border-color: transparent;
            box-shadow: 0 0 10px var(--accent-glow);
            font-weight: 700;
        }

        .hint {
            margin: 8px 0 12px;
            color: var(--text-dim);
            font-size: 0.82rem;
        }

        .grid {
            display: grid;
            gap: 10px;
        }

        .group-section {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 10px;
        }

        .group-title {
            font-size: 0.88rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .group-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 10px;
        }

        .card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 10px;
        }

        .title {
            font-size: 0.9rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: #e8edf1;
        }

        .mini-keyboard-wrap {
            overflow: hidden;
        }

        .mini-keyboard {
            display: flex;
            position: relative;
            width: fit-content;
            background: #000;
            border-radius: 8px;
            padding: 4px;
            height: 84px;
        }

        .mini-key {
            width: 16px;
            height: 76px;
            background: var(--white-key);
            border: 1px solid #cdd5dd;
            border-radius: 0 0 4px 4px;
            position: relative;
            z-index: 1;
            flex-shrink: 0;
        }

        .mini-key.black {
            width: 10px;
            height: 48px;
            background: var(--black-key);
            border: none;
            margin-left: -5px;
            margin-right: -5px;
            z-index: 2;
            border-radius: 0 0 4px 4px;
        }

        .mini-key.root {
            background: var(--root) !important;
            box-shadow: 0 0 8px var(--accent-glow);
        }

        .mini-key.target {
            background: var(--target) !important;
            box-shadow: 0 0 8px rgba(46, 204, 113, 0.45);
        }

        .legend {
            margin-top: 8px;
            font-size: 0.78rem;
            color: var(--text-dim);
        }

        .dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin: 0 5px 0 10px;
            vertical-align: -1px;
        }

        .dot:first-child {
            margin-left: 0;
        }

        .dot.root {
            background: var(--root);
        }

        .dot.target {
            background: var(--target);
        }

    </style>
</head>

<body>
    <div class="page">
        <div class="toolbar">
            <h1>音程助记专页</h1>
            <div class="interval-buttons" id="intervalButtons"></div>
            <div class="hint" id="currentHint"></div>
        </div>

        <div class="grid" id="keyboardGrid"></div>

        <div class="legend">
            <span class="dot root"></span>主音
            <span class="dot target"></span>目标音
        </div>
    </div>

    <script>
        const noteNames = ['C', 'C#', 'D', 'Eb', 'E', 'F', 'F#', 'G', 'Ab', 'A', 'Bb', 'B'];
        const blackIndices = [1, 3, 6, 8, 10];
        const intervals = [
            { label: '小二', semitone: 1 },
            { label: '大二', semitone: 2 },
            { label: '小三', semitone: 3 },
            { label: '大三', semitone: 4 },
            { label: '纯四', semitone: 5 },
            { label: '三全', semitone: 6 },
            { label: '纯五', semitone: 7 },
            { label: '小六', semitone: 8 },
            { label: '大六', semitone: 9 },
            { label: '小七', semitone: 10 },
            { label: '大七', semitone: 11 }
        ];

        let activeInterval = 4;

        function renderButtons() {
            const box = document.getElementById('intervalButtons');
            box.innerHTML = intervals.map(item => `
                <button class="interval-btn ${item.semitone === activeInterval ? 'active' : ''}" data-v="${item.semitone}">
                    ${item.label}
                </button>
            `).join('');

            box.querySelectorAll('.interval-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    activeInterval = Number(btn.dataset.v);
                    renderButtons();
                    renderGrid();
                });
            });
        }

        function buildMiniKeyboard(rootIndex, interval) {
            const board = document.createElement('div');
            board.className = 'mini-keyboard';

            for (let i = 0; i < 24; i++) {
                const noteIndex = i % 12;
                const key = document.createElement('div');
                key.className = `mini-key ${blackIndices.includes(noteIndex) ? 'black' : ''}`;
                if (i === rootIndex) key.classList.add('root');
                if (i === rootIndex + interval) key.classList.add('target');
                board.appendChild(key);
            }
            return board;
        }

        function renderGrid() {
            const grid = document.getElementById('keyboardGrid');
            const current = intervals.find(item => item.semitone === activeInterval);
            document.getElementById('currentHint').textContent = `当前音程：${current.label}（${current.semitone} 半音）`;

            grid.innerHTML = '';
            const order = ['白白', '白黑', '黑白', '黑黑'];
            const groups = { '白白': [], '白黑': [], '黑白': [], '黑黑': [] };

            for (let root = 0; root < 12; root++) {
                const target = (root + activeInterval) % 12;
                const rootIsBlack = blackIndices.includes(root);
                const targetIsBlack = blackIndices.includes(target);
                const type = `${rootIsBlack ? '黑' : '白'}${targetIsBlack ? '黑' : '白'}`;
                groups[type].push({ root, target });
            }

            order.forEach(type => {
                const section = document.createElement('section');
                section.className = 'group-section';
                section.innerHTML = `<div class="group-title">${type}</div>`;

                const groupGrid = document.createElement('div');
                groupGrid.className = 'group-grid';

                groups[type].forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `<div class="title">${noteNames[item.root]} → ${noteNames[item.target]}</div>`;

                    const wrap = document.createElement('div');
                    wrap.className = 'mini-keyboard-wrap';
                    wrap.appendChild(buildMiniKeyboard(item.root, activeInterval));

                    card.appendChild(wrap);
                    groupGrid.appendChild(card);
                });

                section.appendChild(groupGrid);
                grid.appendChild(section);
            });
        }

        renderButtons();
        renderGrid();
    </script>
</body>

</html>
